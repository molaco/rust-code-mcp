[package]
name = "file-search-mcp"
version = "0.1.0"
edition = "2024"

[dependencies]
# MCP and async runtime
rmcp = { git = "https://github.com/modelcontextprotocol/rust-sdk", branch = "main", features = [
  "server",
  "transport-io",
] }
tokio = { version = "1", features = [
  "macros",
  "rt",
  "rt-multi-thread",
  "io-std",
  "signal",
] }

# Search and indexing
tantivy = "0.22.0"

# Serialization
serde = { version = "1.0.219", features = ["derive"] }
serde_json = "1.0"
bincode = "1.3"
uuid = { version = "1.10", features = ["v4", "serde"] }  # Unique IDs for chunks

# Logging
tracing = "0.1"
tracing-subscriber = { version = "0.3", features = [
  "env-filter",
  "std",
  "fmt",
] }

# Phase 1: Persistent Index + Incremental Updates
notify = "6"           # File watching
sled = "0.34"          # Embedded key-value store for metadata cache
sha2 = "0.10"          # SHA-256 file hashing
directories = "5"      # Cross-platform config/data directories

# Phase 2: Tree-sitter Integration + Symbol Extraction
tree-sitter = "0.20"   # AST parsing
tree-sitter-rust = "0.20"  # Rust grammar

# Phase 3: Semantic Code Chunking
text-splitter = "0.13"  # Semantic text chunking

# Phase 4: Embedding Generation
fastembed = { git = "https://github.com/Anush008/fastembed-rs" }  # Local embeddings (ONNX-based) from GitHub
ort = { version = "=2.0.0-rc.10", features = ["cuda", "download-binaries", "ndarray", "std"] }  # ONNX Runtime with CUDA support

# Phase 5: Vector Database
qdrant-client = "1"    # Vector search with Qdrant

# Additional dependencies for Phase 1
walkdir = "2"          # Directory traversal for indexing
anyhow = "1"           # Error handling
regex = "1"            # Secrets scanning patterns
glob = "0.3"           # File pattern matching

# Merkle tree for 100x faster change detection (Week 2)
rs_merkle = "1.4"      # Merkle tree implementation

# Performance monitoring
sysinfo = "0.30"       # System memory monitoring

# Parallel processing
rayon = "1.10"         # Data parallelism
num_cpus = "1.16"      # CPU count detection

[dev-dependencies]
tempfile = "3"         # Temporary directories for tests
